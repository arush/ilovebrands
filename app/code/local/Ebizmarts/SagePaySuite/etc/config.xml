<?xml version="1.0"?>
<config>
    <modules>
        <Ebizmarts_SagePaySuite>
            <version>1.1.13</version>
        </Ebizmarts_SagePaySuite>
    </modules>
    <adminhtml>
        <translate>
            <modules>
                <Ebizmarts_SagePaySuite>
                    <files>
                        <default>Ebizmarts_SagePaySuite.csv</default>
                    </files>
                </Ebizmarts_SagePaySuite>
            </modules>
        </translate>
        <layout>
            <updates>
                <sagepaysuite>
                    <file>sagepaysuite.xml</file>
                </sagepaysuite>
            </updates>
        </layout>
		<events>
	      <controller_action_predispatch>
	          <observers>
	              <sagepaysuite_up>
	                  <type>singleton</type>
	                  <class>sagepaysuite/feed_updates</class>
	                  <method>check</method>
	              </sagepaysuite_up>
	          </observers>
	      </controller_action_predispatch>
            <core_block_abstract_to_html_before>
                <observers>
                    <order_export_addmassbutton>
                        <type>model</type>
                        <class>sagepaysuite/observer_sales</class>
                        <method>updateButton</method>
                    </order_export_addmassbutton>
                </observers>
            </core_block_abstract_to_html_before>
	   </events>
    </adminhtml>
    <global>
        <events>
            <payment_info_block_prepare_specific_information>
                <observers>
                    <sagepaysuite_paymentinfo_block>
                        <class>sagepaysuite/observer_payment</class>
                        <method>addInfo</method>
                    </sagepaysuite_paymentinfo_block>
                </observers>
            </payment_info_block_prepare_specific_information>
            <sales_order_load_after>
                <observers>
                    <sagepaysuite_sla>
                        <class>sagepaysuite/observer_sales</class>
                        <method>loadAfter</method>
                    </sagepaysuite_sla>
                </observers>
            </sales_order_load_after>
            <sales_order_save_after>
                <observers>
                    <sagepaysuite_slafter>
                        <class>sagepaysuite/observer_sales</class>
                        <method>saveAfter</method>
                    </sagepaysuite_slafter>
                </observers>
            </sales_order_save_after>
            <sales_order_save_before>
                <observers>
                    <sagepaysuite_sla>
                        <class>sagepaysuite/observer_sales</class>
                        <method>saveBefore</method>
                    </sagepaysuite_sla>
                </observers>
            </sales_order_save_before>
            <sales_order_payment_cancel>
                <observers>
                    <sagepaysuite_payment_cancel>
                        <class>sagepaysuite/observer_payment</class>
                        <method>cancel</method>
                    </sagepaysuite_payment_cancel>
                </observers>
            </sales_order_payment_cancel>
        </events>
        <fieldsets>
        	<sales_convert_order_payment>
                <cc_gift_aid><to_quote_payment>*</to_quote_payment></cc_gift_aid>
                <remembertoken><to_quote_payment>*</to_quote_payment></remembertoken>
                <repeat_code><to_quote_payment>*</to_quote_payment></repeat_code>
        	</sales_convert_order_payment>
            <sales_convert_quote_payment>
                <sagepay_token_cc_id><to_order_payment>*</to_order_payment></sagepay_token_cc_id>
                <save_token_cc><to_order_payment>*</to_order_payment></save_token_cc>
                <cc_gift_aid><to_order_payment>*</to_order_payment></cc_gift_aid>
                <remembertoken><to_order_payment>*</to_order_payment></remembertoken>
                <repeat_code><to_quote_payment>*</to_quote_payment></repeat_code>
            </sales_convert_quote_payment>
        </fieldsets>
        <payment>
            <cc_sgps>
                <types>
                    <VISA>
                        <code>VISA</code>
                        <name>Visa</name>
                    </VISA>
                    <MC>
                        <code>MC</code>
                        <name>MasterCard</name>
                    </MC>
                    <DELTA>
                        <code>DELTA</code>
                        <name>Visa Debit</name>
                    </DELTA>
                    <SOLO>
                        <code>SOLO</code>
                        <name>Solo</name>
                    </SOLO>
                    <MAESTROUK>
                        <code>SWITCH</code>
                        <name>Maestro UK</name>
                    </MAESTROUK>
                    <MAESTRO>
                        <code>MAESTRO</code>
                        <name>Maestro International</name>
                    </MAESTRO>
                    <AMEX>
                        <code>AMEX</code>
                        <name>American Express</name>
                    </AMEX>
                    <UKE>
                        <code>UKE</code>
                        <name>Visa Electron</name>
                    </UKE>
                    <DINERS>
                        <code>DC</code>
                        <name>Diners Club</name>
                    </DINERS>
                    <JCB>
                        <code>JCB</code>
                        <name>Japan Credit Bureau</name>
                    </JCB>
                    <LASER>
                        <code>LASER</code>
                        <name>Laser</name>
                    </LASER>
                    <PAYPAL>
                        <code>PAYPAL</code>
                        <name>PayPal</name>
                    </PAYPAL>
                </types>
            </cc_sgps>
        </payment>
        <models>
            <sagepaysuite>
                <class>Ebizmarts_SagePaySuite_Model</class>
            </sagepaysuite>
            <sagepaysuite2>
                <class>Ebizmarts_SagePaySuite_Model</class>
                <resourceModel>sagepaysuite_mysql4</resourceModel>
            </sagepaysuite2>
            <sagepaysuite_mysql4>
                <class>Ebizmarts_SagePaySuite_Model_Mysql4</class>
                <entities>
                    <sagepaysuite_session>
                        <table>sagepaysuite_session</table>
                    </sagepaysuite_session>
                    <sagePaySuite_debug>
                        <table>sagepaysuite_debug</table>
                    </sagePaySuite_debug>
                    <sagepaysuite_tokencard>
                        <table>sagepaysuite_tokencard</table>
                    </sagepaysuite_tokencard>
                    <sagepaysuite_transaction>
                        <table>sagepaysuite_transaction</table>
                    </sagepaysuite_transaction>
                    <sagepaysuite_paypaltransaction>
                        <table>sagepaysuite_paypaltransaction</table>
                    </sagepaysuite_paypaltransaction>
                    <sagepaysuite_action>
                        <table>sagepaysuite_action</table>
                    </sagepaysuite_action>
                    <sagepaysuite_fraud>
                        <table>sagepaysuite_fraud</table>
                    </sagepaysuite_fraud>
                </entities>
            </sagepaysuite_mysql4>
        </models>
        <blocks>
            <sagepaysuite>
                <class>Ebizmarts_SagePaySuite_Block</class>
            </sagepaysuite>
        </blocks>
        <helpers>
            <sagepaysuite>
                <class>Ebizmarts_SagePaySuite_Helper</class>
            </sagepaysuite>

            <payment>
                <rewrite>
                    <data>Ebizmarts_SagePaySuite_Helper_Payment_Data</data>
                </rewrite>
            </payment>

        </helpers>
        <resources>
            <sagepaysuite_setup>
                <setup>
                    <module>Ebizmarts_SagePaySuite</module>
                    <class>Mage_Eav_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </sagepaysuite_setup>
            <sagepaysuite_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </sagepaysuite_write>
            <sagepaysuite_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </sagepaysuite_read>

            <sagepaysuite2_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </sagepaysuite2_write>
            <sagepaysuite2_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </sagepaysuite2_read>
        </resources>
        <template>
            <email>
                <sagepay_timeout_template translate="label" module="sagepaysuite">
                    <label>SagePayDirectPro Timeout</label>
                    <file>sagepaysuite/timeout.html</file>
                    <type>html</type>
                </sagepay_timeout_template>
            </email>
        </template>
    </global>
    <default>
    	<sagepayreporting>
    		<account>
	    		<vendor>testebizmarts</vendor>
    			<enviroment>2</enviroment>
    		</account>
    	</sagepayreporting>
        <sagepaysuite>
            <notifications>
                <updates_url><![CDATA[http://ebizmarts.com/notifications/feed/notifications]]></updates_url>
                <check_frequency>86400</check_frequency>
            </notifications>
        </sagepaysuite>
        <payment>
            <sagepaysuite>
                <referrer_id><![CDATA[01bf51f9-0dcd-49dd-a07a-3b1f918c77d7]]></referrer_id>
                <license_key><![CDATA[[Obtain from Ebizmarts]]]></license_key>
                <connection_timeout>90</connection_timeout>
                <max_token_card>6</max_token_card>
                <logs>0</logs>
                <profile_request>0</profile_request>
                <vendor>testebizmarts</vendor>
                <token_integration><![CDATA[false]]></token_integration>
                <cms_index_logo>1</cms_index_logo>
                <sagepay_notifications>1</sagepay_notifications>
                <orphans_notification>1</orphans_notification>
                <order_error_save>0</order_error_save>
                <order_error_save_message><![CDATA[Order saving process halted.]]></order_error_save_message>
                <timeout_message><![CDATA[A connection error prevented your order from being saved, please retry or email {admin_email} for assistance. Thanks, {store_name}]]></timeout_message>
                <auto_fulfill_low_risk_trn>0</auto_fulfill_low_risk_trn>
                <auto_fulfill_low_risk_trn_value>30</auto_fulfill_low_risk_trn_value>
                <send_basket>1</send_basket>
                <deferred_capture>0</deferred_capture>
            </sagepaysuite>
            <sagepaydirectpro>
                <active>0</active>
                <cctypesSagePayDirectPro>VISA,MC,DELTA,SOLO,SWITCH,UKE</cctypesSagePayDirectPro>
                <cctypes>VISA,MC,DELTA,SWITCH,MAESTRO,UKE</cctypes>
                <debug>0</debug>
                <email_customer>0</email_customer>
                <login backend_model="adminhtml/system_config_backend_encrypted"/>
                <model>sagepaysuite/sagePayDirectPro</model>
                <order_status>pending</order_status>
                <fail_order_status>pending</fail_order_status>
                <payment_action>authorize_capture</payment_action>
                <secure3d>0</secure3d>
                <mode>test</mode>
                <title>Credit Card (Sage Pay)</title>
                <trans_key backend_model="adminhtml/system_config_backend_encrypted"/>
                <allowspecific>0</allowspecific>
                <vendor>testebizmarts</vendor>
                <email_timeout_identity>general</email_timeout_identity>
                <email_timeout_template>sagepay_timeout_template</email_timeout_template>
                <connection_timeout>10</connection_timeout>
                <timeout_orders>0</timeout_orders>
                <threed_iframe_height>500</threed_iframe_height>
                <threed_iframe_width>600</threed_iframe_width>
                <avscv2>0</avscv2>
            </sagepaydirectpro>
            <sagepaydirectpro_moto>
                <active>0</active>
                <accounttype>M</accounttype>
                <cctypesSagePayDirectPro>VISA,MC,DELTA,SWITCH,MAESTRO,AMEX,UKE,DINERS,JCB,LASER</cctypesSagePayDirectPro>
                <cctypes>VISA,MC,DELTA,SWITCH,MAESTRO,AMEX,UKE,DINERS,JCB,LASER</cctypes>
                <debug>0</debug>
                <currency>GBP</currency>
                <email_customer>0</email_customer>
                <login backend_model="adminhtml/system_config_backend_encrypted"/>
                <model>sagepaysuite/sagePayDirectProMoto</model>
                <order_status>pending</order_status>
                <fail_order_status>pending</fail_order_status>
                <payment_action>authorize_capture</payment_action>
                <mode>test</mode>
                <title>Credit Card (Sage Pay) MOTO</title>
                <trans_key backend_model="adminhtml/system_config_backend_encrypted"/>
                <allowspecific>0</allowspecific>
                <vendor>testebizmarts</vendor>
                <email_timeout_identity>general</email_timeout_identity>
                <email_timeout_template>sagepay_timeout_template</email_timeout_template>
                <connection_timeout>10</connection_timeout>
                <timeout_orders>0</timeout_orders>
                <threed_iframe_height>500</threed_iframe_height>
                <threed_iframe_width>600</threed_iframe_width>
                <timeout_message>A connection error prevented your order from being saved, please retry or email [admin_email] for assistance. Thanks , [store_name]</timeout_message>
                <avscv2>0</avscv2>
                <flag_on_cache>0</flag_on_cache>
            </sagepaydirectpro_moto>
            <sagepayserver>
                <avscv2>0</avscv2>
                <active>0</active>
                <debug>0</debug>
                <model>sagepaysuite/sagePayServer</model>
                <order_status>pending</order_status>
                <title>Sage Pay Server</title>
                <allowspecific>0</allowspecific>
                <vendor>testebizmarts</vendor>
                <mode>test</mode>
                <payment_iframe_position>modal</payment_iframe_position>
                <iframe_label>Sage Pay Server</iframe_label>
                <payment_action>payment</payment_action>
                <purchase_description>Purchase of products ECOMMERCE</purchase_description>
                <selected_description><![CDATA[Enter your credit card details after Order Review<br />{{secured_logo}}]]></selected_description>
                <auto_show_iframe>0</auto_show_iframe>
                <iframe_height>800</iframe_height>
                <iframe_width>800</iframe_width>
                <token_iframe_height>550</token_iframe_height>
                <token_iframe_width>550</token_iframe_width>
            </sagepayserver>
            <sagepayserver_moto>
                <active>0</active>
                <debug>0</debug>
                <avscv2>0</avscv2>
                <model>sagepaysuite/sagePayServerMoto</model>
                <order_status>pending</order_status>
                <title>Sage Pay Server MOTO</title>
                <payment_action>payment</payment_action>
                <allowspecific>0</allowspecific>
                <vendor>testebizmarts</vendor>
                <mode>test</mode>
                <purchase_description>Purchase of products MOTO</purchase_description>
            </sagepayserver_moto>
            <sagepayform>
            	<active>0</active>
            	<send_email>1</send_email>
            	<payment_action>payment</payment_action>
            	<mode>test</mode>
            	<title>Sage Pay (FORM)</title>
            	<order_status>pending</order_status>
                <selected_description><![CDATA[You will be redirected to the Sage Pay website when you place an order.<br />{{secured_logo}}]]></selected_description>
                <model>sagepaysuite/sagePayForm</model>
                <allowspecific>0</allowspecific>
            </sagepayform>
            <sagepaypaypal>
            	<active>0</active>
            	<payment_action>payment</payment_action>
            	<title>PayPal via SagePay</title>
            	<model>sagepaysuite/sagePayPayPal</model>
            </sagepaypaypal>
            <sagepayrepeat>
            	<active>0</active>
            	<title>Repeat Payments</title>
            	<model>sagepaysuite/sagePayRepeat</model>
            </sagepayrepeat>
        </payment>
    </default>
    <frontend>
        <translate>
            <modules>
                <Ebizmarts_SagePaySuite>
                    <files>
                        <default>Ebizmarts_SagePaySuite.csv</default>
                    </files>
                </Ebizmarts_SagePaySuite>
            </modules>
        </translate>
        <secure_url>
            <sagepaysuite>/sgps/</sagepaysuite>
        </secure_url>
        <routers>
            <sagepaysuite>
                <use>standard</use>
                <args>
                    <module>Ebizmarts_SagePaySuite</module>
                    <frontName>sgps</frontName>
                </args>
            </sagepaysuite>
        </routers>
        <layout>
            <updates>
                <sagepaysuite>
                    <file>sagepaysuite.xml</file>
                </sagepaysuite>
            </updates>
        </layout>
        <events>
            <customer_login>
                <observers>
                    <customer_login_sagepay>
                        <class>sagepaysuite/observer_customer</class>
                        <method>addRegisterCheckoutTokenCards</method>
                    </customer_login_sagepay>
                </observers>
            </customer_login>
            <controller_action_predispatch_onestepcheckout_index_index>
                <observers>
                    <onepage_sagepay_clear_session>
                        <class>sagepaysuite/observer_checkout</class>
                        <method>controllerOnePageClear</method>
                    </onepage_sagepay_clear_session>
                </observers>
            </controller_action_predispatch_onestepcheckout_index_index>
            <controller_action_predispatch_checkout_onepage_index>
                <observers>
                    <onepage_sagepay_clear_session>
                        <class>sagepaysuite/observer_checkout</class>
                        <method>controllerOnePageClear</method>
                    </onepage_sagepay_clear_session>
                </observers>
            </controller_action_predispatch_checkout_onepage_index>
            <controller_action_predispatch_checkout_onepage_success>
                <observers>
                    <onepage_sagepay_clear_session>
                        <class>sagepaysuite/observer_checkout</class>
                        <method>controllerOnePageSuccess</method>
                    </onepage_sagepay_clear_session>
                </observers>
            </controller_action_predispatch_checkout_onepage_success>
	        <checkout_onepage_controller_success_action>
	           	<observers>
	               <sagepay_deferred_capture>
	                   <class>sagepaysuite/observer_checkout</class>
	                   <method>deferredCapture</method>
	               </sagepay_deferred_capture>
	         	</observers>
	        </checkout_onepage_controller_success_action>
            <core_layout_update_updates_get_after>
                <observers>
                    <sagepaysuite_core_layout_update_updates_get_after>
                        <type>singleton</type>
                        <class>sagepaysuite/observer</class>
                        <method>layoutUpdate</method>
                    </sagepaysuite_core_layout_update_updates_get_after>
                </observers>
            </core_layout_update_updates_get_after>
            <sales_convert_quote_to_order>
                <observers>
                    <sagepaysuite_sales_convert_quote_to_order>
                        <type>singleton</type>
                        <class>sagepaysuite/observer_sales</class>
                        <method>quoteToOrder</method>
                    </sagepaysuite_sales_convert_quote_to_order>
                </observers>
            </sales_convert_quote_to_order>
            <checkout_type_multishipping_create_orders_single>
                <observers>
                    <sagepaysuite_multishipping_create_orders_single>
                        <class>sagepaysuite/observer_payment</class>
                        <method>multiShipping</method>
                    </sagepaysuite_multishipping_create_orders_single>
                </observers>
            </checkout_type_multishipping_create_orders_single>
            <controller_action_predispatch_checkout_multishipping_success>
                <observers>
                    <multishipping_sagepay_clear_session>
                        <class>sagepaysuite/observer_checkout</class>
                        <method>controllerMultishippingClear</method>
                    </multishipping_sagepay_clear_session>
                </observers>
            </controller_action_predispatch_checkout_multishipping_success>
            <controller_action_predispatch_checkout_multishipping_index_index>
                <observers>
                    <multishipping_sagepay_clear_session>
                        <class>sagepaysuite/observer_checkout</class>
                        <method>controllerMultishippingClear</method>
                    </multishipping_sagepay_clear_session>
                </observers>
            </controller_action_predispatch_checkout_multishipping_index_index>
            <controller_action_predispatch>
                <observers>
                    <profilerequestpre>
                        <class>sagepaysuite/observer</class>
                        <method>profilePre</method>
                    </profilerequestpre>
                </observers>
            </controller_action_predispatch>
            <controller_action_postdispatch>
                <observers>
                    <profilerequestpost>
                        <class>sagepaysuite/observer</class>
                        <method>profilePost</method>
                    </profilerequestpost>
                </observers>
            </controller_action_postdispatch>
        </events>
    </frontend>
    <admin>
        <routers>
            <sagepaysuite>
                <use>admin</use>
                <args>
                    <module>Ebizmarts_SagePaySuite</module>
                    <frontName>sgpsSecure</frontName>
                </args>
            </sagepaysuite>
        </routers>
    </admin>
</config>

