OrderReviewController=Class.create();OrderReviewController.prototype={_canSubmitOrder:false,_pleaseWait:false,shippingSelect:false,onSubmitShippingSuccess:false,initialize:function(d,a,c,e,b,f){if(!d){return}this.form=d;if(a){this.formSubmit=a;Event.observe(a,"click",this._submitOrder.bind(this))}if(e&&c){this.shippingSelect=c;Event.observe(c,"change",this._submitShipping.bindAsEventListener(this,e.action,b));this._updateOrderSubmit(false)}else{this._canSubmitOrder=true}},addPleaseWait:function(a){if(a){this._pleaseWait=a}},_submitShipping:function(c,b,a){if(this.shippingSelect&&b&&a){this._updateOrderSubmit(true);if(this._pleaseWait){this._pleaseWait.show()}if(""!=this.shippingSelect.value){new Ajax.Updater(a,b,{parameters:{isAjax:true,shipping_method:this.shippingSelect.value},onComplete:function(){if(this._pleaseWait){this._pleaseWait.hide()}}.bind(this),onSuccess:this._onSubmitShippingSuccess.bind(this),evalScripts:true})}}},_submitOrder:function(){if(this._canSubmitOrder){this.form.submit();this._updateOrderSubmit(true);if(this._pleaseWait){this._pleaseWait.show()}}},_onSubmitShippingSuccess:function(){this._updateOrderSubmit(false);if(this.onSubmitShippingSuccess){this.onSubmitShippingSuccess()}},_updateOrderSubmit:function(b){var a=b||!this.shippingSelect||""==this.shippingSelect.value;this._canSubmitOrder=!a;if(this.formSubmit){this.formSubmit.disabled=a;this.formSubmit.removeClassName("no-checkout");this.formSubmit.setStyle({opacity:1});if(a){this.formSubmit.addClassName("no-checkout");this.formSubmit.setStyle({opacity:0.5})}}}};