if(typeof(Prototype)=="undefined"){throw"Event.Behavior requires Prototype to be loaded."}if(typeof(Object.Event)=="undefined"){throw"Event.Behavior requires Object.Event to be loaded."}Event.Behavior={addVerbs:function(c){var a;for(var b in c){if(c.hasOwnProperty(b)){a=new Event.Behavior.Verb(c[b]);Event.Behavior.Verbs[b]=a;Event.Behavior[b.underscore()]=Event.Behavior[b]=a.getCallbackForStack.bind(a)}}},addEvents:function(a){$H(a).each(function(b){Event.Behavior.Adjective.prototype[b.key.underscore()]=Event.Behavior.Adjective.prototype[b.key]=function(){this.nextConditionType="and";this.events.push(b.value);this.attachObserver(false);return this}})},invokeElementMethod:function(b,c,a){if(typeof(b)=="function"){return $A(b()).each(function(d){if(typeof(a[0])=="function"){return $A(a[0]).each(function(e){return $(d)[c].apply($(d),(e?[e]:[]))})}else{return $(d)[c].apply($(d),a||[])}})}else{return $(b)[c].apply($(b),a||[])}}};Event.Behavior.Verbs=$H({});Event.Behavior.Verb=Class.create();Object.extend(Event.Behavior.Verb.prototype,{originalAction:false,execute:false,executeOpposite:false,target:false,initialize:function(a){this.originalAction=a;this.execute=function(c,d,b){return(b)?c(d,b):c(d)}.bind(this,a)},setOpposite:function(b){var a=b.originalAction;this.executeOpposite=function(c,e,d){return(d)?c(e,d):c(e)}.bind(this,a)},getCallbackForStack:function(a){return new Event.Behavior.Noun(this,a)}});Event.Behavior.addVerbs({call:function(a){a()},show:function(a){return Event.Behavior.invokeElementMethod(a,"show")},hide:function(a){return Event.Behavior.invokeElementMethod(a,"hide")},remove:function(a){return Event.Behavior.invokeElementMethod(a,"remove")},setStyle:function(a,b){return Event.Behavior.invokeElementMethod(a,"setStyle",[(typeof(b)=="function"?b():b)])},addClassName:function(a,b){return Event.Behavior.invokeElementMethod(a,"addClassName",[(typeof(b)=="function"?b():b)])},removeClassName:function(a,b){return Event.Behavior.invokeElementMethod(a,"removeClassName",[(typeof(b)=="function"?b():b)])},setClassName:function(a,b){var d=(typeof(b)=="function")?b():b;if(typeof(a)=="function"){return $A(a()).each(function(c){$(c).className=d})}else{d=$(a).className;return d}},update:function(b,a){return Event.Behavior.invokeElementMethod(a,"update",[(typeof(b)=="function"?b():b)])},replace:function(b,a){return Event.Behavior.invokeElementMethod(a,"replace",[(typeof(b)=="function"?b():b)])}});Event.Behavior.Verbs.show.setOpposite(Event.Behavior.Verbs.hide);Event.Behavior.Verbs.hide.setOpposite(Event.Behavior.Verbs.show);Event.Behavior.Verbs.addClassName.setOpposite(Event.Behavior.Verbs.removeClassName);Event.Behavior.Verbs.removeClassName.setOpposite(Event.Behavior.Verbs.addClassName);Event.Behavior.Noun=Class.create();Object.extend(Event.Behavior.Noun.prototype,{verbs:false,verb:false,argument:false,subject:false,target:false,initialize:function(b,a){this.verb=b;this.argument=a},execute:function(){return(this.target)?this.verb.execute(this.target,this.argument):this.verb.execute(this.argument)},executeOpposite:function(){return(this.target)?this.verb.executeOpposite(this.target,this.argument):this.verb.executeOpposite(this.argument)},when:function(a){this.subject=a;return new Event.Behavior.Adjective(this)},getValue:function(){return Try.these(function(){return $(this.subject).getValue()}.bind(this),function(){return $(this.subject).options[$(this.subject).options.selectedIndex].value}.bind(this),function(){return $(this.subject).value}.bind(this),function(){return $(this.subject).innerHTML}.bind(this))},containsValue:function(a){var b=this.getValue();if(typeof(a)=="function"){return $A(a()).include(b)}else{return b.match(a)}},setTarget:function(a){this.target=a;return this},and:function(){}});Event.Behavior.Noun.prototype._with=Event.Behavior.Noun.prototype.setTarget;Event.Behavior.Noun.prototype.on=Event.Behavior.Noun.prototype.setTarget;Event.Behavior.Noun.prototype.of=Event.Behavior.Noun.prototype.setTarget;Event.Behavior.Noun.prototype.to=Event.Behavior.Noun.prototype.setTarget;Event.Behavior.Noun.prototype.from=Event.Behavior.Noun.prototype.setTarget;Event.Behavior.Adjective=Class.create();Object.extend(Event.Behavior.Adjective.prototype,{noun:false,lastConditionName:"",nextConditionType:"and",conditions:$A([]),events:$A([]),attached:false,initialize:function(a){this.conditions=$A([]);this.events=$A([]);this.noun=a},attachObserver:function(a){if(this.attached){if(a){this.execute()}return}this.attached=true;if(typeof(this.noun.subject)=="function"){$A(this.noun.subject()).each(function(b){(this.events.length>0?this.events:$A(["change"])).each(function(c){(b.observe?b:$(b)).observe(c,function(){this.execute()}.bind(this))}.bind(this))}.bind(this))}else{(this.events.length>0?this.events:$A(["change"])).each(function(b){$(this.noun.subject).observe(b,function(){this.execute()}.bind(this))}.bind(this))}if(a){this.execute()}},execute:function(){if(this.match()){return this.noun.execute()}else{if(this.noun.verb.executeOpposite){this.noun.executeOpposite()}}},attachCondition:function(a){this.conditions.push([this.nextConditionType,a.bind(this)])},match:function(){if(this.conditions.length===0){return true}else{return this.conditions.inject(false,function(a,b){return(b[0]==="or")?(a&&b[1]()):(a||b[1]())})}},is:function(a){this.lastConditionName="is";this.attachCondition(function(b){return(typeof(b)=="function"?b():b)==this.noun.getValue()}.bind(this,a));this.attachObserver(true);return this},isNot:function(a){this.lastConditionName="isNot";this.attachCondition(function(b){return(typeof(b)=="function"?b():b)!=this.noun.getValue()}.bind(this,a));this.attachObserver(true);return this},contains:function(a){this.lastConditionName="contains";this.attachCondition(function(b){return this.noun.containsValue(b)}.bind(this,a));this.attachObserver(true);return this},within:function(a){this.lastConditionName="within";this.attachCondition(function(b){}.bind(this,a));this.attachObserver(true);return this},change:function(){this.nextConditionType="and";this.attachObserver(true);return this},and:function(a){this.attached=false;this.nextConditionType="and";if(a){this[this.lastConditionName](a)}return this},or:function(a){this.attached=false;this.nextConditionType="or";if(a){this[this.lastConditionName](a)}return this}});Event.Behavior.addEvents({losesFocus:"blur",gainsFocus:"focus",isClicked:"click",isDoubleClicked:"dblclick",keyPressed:"keypress"});Event.Behavior.Adjective.prototype.is_not=Event.Behavior.Adjective.prototype.isNot;Event.Behavior.Adjective.prototype.include=Event.Behavior.Adjective.prototype.contains;Event.Behavior.Adjective.prototype.includes=Event.Behavior.Adjective.prototype.contains;Event.Behavior.Adjective.prototype.are=Event.Behavior.Adjective.prototype.is;Event.Behavior.Adjective.prototype.areNot=Event.Behavior.Adjective.prototype.isNot;Event.Behavior.Adjective.prototype.are_not=Event.Behavior.Adjective.prototype.isNot;Event.Behavior.Adjective.prototype.changes=Event.Behavior.Adjective.prototype.change;